clear all;

%Link:http://depa.fquim.unam.mx/amyd/archivero/DormandPrince_19856.pdf
%ode5 e ode45
%(@(x,y) y*sin(x)*cos(x),-0.5,-1,0.1,10)
function [X,Y] = DormandPrince (f, x0, y0, h, n)

  X = zeros(1,n+1); Y = zeros(1,n+1);

  x = x0; y = y0;
	X(1) = x; Y(1) = y;
  
  for i = 2 : n+1
    k1 = h*f( x , y );
    k2 = h*f( x + (1/5)*h , y + (1/5)*k1 );
    k3 = h*f( x + (3/10)*h , y + (3/40)*k1 + (9/40)*k2 );
    k4 = h*f( x + (4/5)*h , y +(44/45)*k1 - (56/15)*k2 + (32/9)*k3 );
    k5 = h*f( x + (8/9)*h , y + (19372/6561)*k1 - (25360/2187)*k2 + (64448/6561)*k3 - (212/729)*k4 );
    k6 = h*f( x + h , y + (9017/3168)*k1 - (335/33)*k2 - (46732/5247)*k3 + (49/176)*k4 - (5103/18656)*k5 );
    k7 = h*f( x + h , y + (35/384)*k1 + (500/1113)*k3 + (125/192)*k4 - (2187/6784)*k5 + (11/84)* k6 );
		
    novo_y = y + (35/384)*k1 + (500/1113)*k3 + (125/192)*k4 - (2187/6784)*k5 + (11/84)*k6; 
	  %novo_y = y + (5179/57600)*k1 + (7571/16695)*k3 + (393/640)*k4 - (92097/339200)*k5 + (187/2100)*k6 + (1/40)*k7;

	  x = x + h;
	  y = novo_y;
	  X(i) = x;	Y(i) = novo_y;
	end

end	
